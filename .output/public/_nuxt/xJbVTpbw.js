import{_ as f}from"./CyeEiYbI.js";import{_ as h}from"./DyabKexD.js";import{_}from"./BwUjpYiu.js";import{e as y,P as b,c as o,b as n,t as s,F as p,w as d,g as c,o as i,a as e,d as u,k,r as w}from"./BpnP_1c4.js";import{u as $}from"./BIUpqFe3.js";import{_ as x}from"./DlAUqK2U.js";import"./Dvi7YPqy.js";import"./FoZdgCff.js";import"./BRJawhm2.js";import"./BIYn82lU.js";const C=y({name:"DatasetDetail",data(){return{dataset:null,loading:!0,error:"",ingesting:!1}},computed:{sourceLabel(){if(!this.dataset?.source)return"Upload";const t=this.dataset.source;return t.type==="s3"?`S3 ${t.bucket||""} ${t.prefix||""}`.trim():t.type==="gcs"?`GCS ${t.bucket||""} ${t.prefix||""}`.trim():t.type==="hf"?`Hugging Face ${t.dataset||""}`.trim():String(t.type||"upload")},canIngest(){return!!this.dataset&&["s3","gcs","hf"].includes(this.dataset.source?.type||"")},statusClass(){return this.dataset?this.dataset.status==="ready"?"text-emerald-600":this.dataset.status==="failed"?"text-destructive":"text-amber-600":""}},setup(){const{apiFetch:t}=$();return{apiFetch:t}},async mounted(){await this.load()},methods:{async load(){this.loading=!0,this.error="";const t=(this._.provides[b]||this.$route).params.id;try{this.dataset=await this.apiFetch(`/api/datasets/${t}`)}catch(a){this.error=a.message||"Failed to load dataset"}finally{this.loading=!1}},async runIngestion(){if(this.dataset){this.ingesting=!0;try{await this.apiFetch(`/api/datasets/${this.dataset.id}/ingest`,{method:"POST"}),await this.load()}catch(t){this.error=t.message||"Ingestion failed"}finally{this.ingesting=!1}}}}}),S={class:"app-page"},v={key:0,class:"text-muted-foreground text-sm"},I={key:1,class:"app-error"},F={class:"text-sm text-muted-foreground"},D={class:"text-sm text-muted-foreground mt-1"},P={key:0,class:"mt-3"},A={key:0,class:"space-y-2 text-sm"},N={class:"font-mono"},R={class:"text-muted-foreground"},V={class:"text-muted-foreground"},q={key:1,class:"text-muted-foreground text-sm"},B={class:"space-y-2 text-sm text-muted-foreground"};function L(t,a,H,O,Q,T){const m=f,g=h,l=_;return i(),o("div",S,[n(m,{title:"Dataset — Preview & quality",description:"Quality report and preview. Run ingestion to sync from source.","back-to":"/app/datasets","back-label":"Datasets"}),t.loading?(i(),o("p",v,"Loading…")):t.error?(i(),o("p",I,s(t.error),1)):t.dataset?(i(),o(p,{key:2},[n(l,{class:"mb-4"},{default:d(()=>[a[1]||(a[1]=e("h3",{class:"app-section-title mb-2"},"Overview",-1)),e("p",F,[a[0]||(a[0]=u(" Status: ",-1)),e("span",{class:k(t.statusClass)},s(t.dataset.status),3),u(" · Rows: "+s(t.dataset.row_count??"—"),1)]),e("p",D," Source: "+s(t.sourceLabel),1),t.canIngest?(i(),o("div",P,[n(g,{disabled:t.ingesting,onClick:t.runIngestion},{default:d(()=>[u(s(t.ingesting?"Ingesting…":"Run ingestion"),1)]),_:1},8,["disabled","onClick"])])):c("",!0)]),_:1}),n(l,{class:"mb-4"},{default:d(()=>[a[2]||(a[2]=e("h3",{class:"app-section-title mb-4"},"Versions",-1)),t.dataset.versions?.length?(i(),o("ul",A,[(i(!0),o(p,null,w(t.dataset.versions,r=>(i(),o("li",{key:r.id,class:"flex justify-between rounded border border-border/50 px-3 py-2"},[e("span",N,s(r.tag),1),e("span",R,s(r.status),1),e("span",V,s(r.row_count??"—")+" rows",1)]))),128))])):(i(),o("p",q,"No versions yet. Run ingestion to create one."))]),_:1}),n(l,null,{default:d(()=>[a[3]||(a[3]=e("h3",{class:"app-section-title mb-4"},"Quality report",-1)),e("ul",B,[e("li",null,"Duplication: "+s(t.dataset.quality?.duplication_pct??"—")+"%",1),e("li",null,"PII flagged: "+s(t.dataset.quality?.pii_flagged??"—"),1),e("li",null,"Schema adherence: "+s(t.dataset.quality?.schema_adherence??"—")+"%",1)])]),_:1})],64)):c("",!0)])}const Y=x(C,[["render",L]]);export{Y as default};
