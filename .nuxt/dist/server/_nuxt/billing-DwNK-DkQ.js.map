{"version":3,"file":"billing-DwNK-DkQ.js","sources":["../../../../pages/app/billing.vue"],"sourcesContent":["<template>\n  <div class=\"app-page\">\n    <AppPageHeader title=\"Billing & usage\" />\n    <p v-if=\"loading\" class=\"text-muted-foreground text-sm\">Loading…</p>\n    <template v-else>\n      <AppCard class=\"mb-4\">\n        <h3 class=\"app-section-title mb-4\">Current period</h3>\n        <ul class=\"space-y-2 text-sm text-muted-foreground\">\n          <li>Period: {{ usage.period_start }} – {{ usage.period_end }}</li>\n          <li>Compute (GPU hours): {{ usage.compute_gpu_hours }} — ${{ (usage.compute_gpu_hours * 1.56).toFixed(2) }}</li>\n          <li>Storage (GB-months): {{ usage.storage_gb_months }} — ${{ (usage.storage_gb_months * 0.036).toFixed(2) }}</li>\n          <li><strong class=\"text-zinc-900\">Total: ${{ usage.total_usd.toFixed(2) }}</strong></li>\n        </ul>\n        <p class=\"text-muted text-sm mt-4\">Forecast: ~${{ (usage.forecast_usd ?? usage.total_usd).toFixed(2) }}</p>\n        <AppButton v-if=\"!stripeConnected\" class=\"mt-4\" variant=\"secondary\" :disabled=\"settingUp\" @click=\"setupCustomer\">\n          {{ settingUp ? 'Setting up…' : 'Connect Stripe for billing' }}\n        </AppButton>\n      </AppCard>\n      <AppCard>\n        <h3 class=\"app-section-title mb-4\">Invoices</h3>\n        <ul v-if=\"invoices.length\" class=\"space-y-2 text-sm\">\n          <li v-for=\"inv in invoices\" :key=\"inv.id\" class=\"flex justify-between\">\n            <span>{{ inv.id }}</span>\n            <span>${{ inv.amount_usd.toFixed(2) }}</span>\n            <span>{{ inv.status }}</span>\n          </li>\n        </ul>\n        <p v-else class=\"text-muted-foreground text-sm\">No invoices yet.</p>\n      </AppCard>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\ndefinePageMeta({ layout: 'app' })\n\nexport default defineComponent({\n  name: 'BillingPage',\n  data() {\n    return {\n      usage: {\n        period_start: '',\n        period_end: '',\n        compute_gpu_hours: 24.5,\n        storage_gb_months: 120,\n        total_usd: 42.5,\n        forecast_usd: 55,\n      },\n      invoices: [] as Array<{ id: string; amount_usd: number; status: string }>,\n      loading: true,\n      settingUp: false,\n      stripeConnected: false,\n    }\n  },\n  setup() {\n    const { apiFetch } = useAployApi()\n    return { apiFetch }\n  },\n  async mounted() {\n    await this.load()\n  },\n  methods: {\n    async load() {\n      this.loading = true\n      try {\n        const [usageRes, invRes] = await Promise.all([\n          this.apiFetch<typeof this.usage>('/api/billing/usage'),\n          this.apiFetch<{ invoices: typeof this.invoices }>('/api/billing/invoices'),\n        ])\n        this.usage = usageRes\n        this.invoices = invRes.invoices ?? []\n        this.stripeConnected = this.invoices.length > 0 || (usageRes as { stripe_customer_id?: string }).stripe_customer_id !== undefined\n      } catch {\n        this.usage = {\n          period_start: new Date().toISOString().slice(0, 10),\n          period_end: new Date().toISOString().slice(0, 10),\n          compute_gpu_hours: 24.5,\n          storage_gb_months: 120,\n          total_usd: 42.5,\n          forecast_usd: 55,\n        }\n      } finally {\n        this.loading = false\n      }\n    },\n    async setupCustomer() {\n      this.settingUp = true\n      try {\n        await this.apiFetch<{ stripe_customer_id: string }>('/api/billing/setup-customer', { method: 'POST' })\n        this.stripeConnected = true\n        await this.load()\n      } catch (e) {\n        alert((e as Error).message || 'Setup failed')\n      } finally {\n        this.settingUp = false\n      }\n    },\n  },\n})\n</script>\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderComponent","_withCtx","_push","_parent","_ssrInterpolate","_","_scopeId","_createVNode","_toDisplayString","_createBlock","_createTextVNode","_ssrRenderList","_Fragment","_renderList"],"mappings":"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"}