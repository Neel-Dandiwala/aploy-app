import{_ as m}from"./CyeEiYbI.js";import{_ as g}from"./DyabKexD.js";import{_}from"./BwUjpYiu.js";import{u as h}from"./BIUpqFe3.js";import{e as f,c as i,b as r,F as p,w as l,o,a as e,t as s,i as y,d as b,g as C,r as F}from"./BpnP_1c4.js";import{_ as k}from"./DlAUqK2U.js";import"./Dvi7YPqy.js";import"./FoZdgCff.js";import"./BRJawhm2.js";import"./BIYn82lU.js";const v=f({name:"BillingPage",data(){return{usage:{period_start:"",period_end:"",compute_gpu_hours:24.5,storage_gb_months:120,total_usd:42.5,forecast_usd:55},invoices:[],loading:!0,settingUp:!1,stripeConnected:!1}},setup(){const{apiFetch:t}=h();return{apiFetch:t}},async mounted(){await this.load()},methods:{async load(){this.loading=!0;try{const[t,a]=await Promise.all([this.apiFetch("/api/billing/usage"),this.apiFetch("/api/billing/invoices")]);this.usage=t,this.invoices=a.invoices??[],this.stripeConnected=this.invoices.length>0||t.stripe_customer_id!==void 0}catch{this.usage={period_start:new Date().toISOString().slice(0,10),period_end:new Date().toISOString().slice(0,10),compute_gpu_hours:24.5,storage_gb_months:120,total_usd:42.5,forecast_usd:55}}finally{this.loading=!1}},async setupCustomer(){this.settingUp=!0;try{await this.apiFetch("/api/billing/setup-customer",{method:"POST"}),this.stripeConnected=!0,await this.load()}catch(t){alert(t.message||"Setup failed")}finally{this.settingUp=!1}}}}),S={class:"app-page"},w={key:0,class:"text-muted-foreground text-sm"},$={class:"space-y-2 text-sm text-muted-foreground"},x={class:"text-zinc-900"},B={class:"text-muted text-sm mt-4"},P={key:0,class:"space-y-2 text-sm"},U={key:1,class:"text-muted-foreground text-sm"};function A(t,a,N,V,D,I){const d=m,c=g,u=_;return o(),i("div",S,[r(d,{title:"Billing & usage"}),t.loading?(o(),i("p",w,"Loading…")):(o(),i(p,{key:1},[r(u,{class:"mb-4"},{default:l(()=>[a[0]||(a[0]=e("h3",{class:"app-section-title mb-4"},"Current period",-1)),e("ul",$,[e("li",null,"Period: "+s(t.usage.period_start)+" – "+s(t.usage.period_end),1),e("li",null,"Compute (GPU hours): "+s(t.usage.compute_gpu_hours)+" — $"+s((t.usage.compute_gpu_hours*1.56).toFixed(2)),1),e("li",null,"Storage (GB-months): "+s(t.usage.storage_gb_months)+" — $"+s((t.usage.storage_gb_months*.036).toFixed(2)),1),e("li",null,[e("strong",x,"Total: $"+s(t.usage.total_usd.toFixed(2)),1)])]),e("p",B,"Forecast: ~$"+s((t.usage.forecast_usd??t.usage.total_usd).toFixed(2)),1),t.stripeConnected?C("",!0):(o(),y(c,{key:0,class:"mt-4",variant:"secondary",disabled:t.settingUp,onClick:t.setupCustomer},{default:l(()=>[b(s(t.settingUp?"Setting up…":"Connect Stripe for billing"),1)]),_:1},8,["disabled","onClick"]))]),_:1}),r(u,null,{default:l(()=>[a[1]||(a[1]=e("h3",{class:"app-section-title mb-4"},"Invoices",-1)),t.invoices.length?(o(),i("ul",P,[(o(!0),i(p,null,F(t.invoices,n=>(o(),i("li",{key:n.id,class:"flex justify-between"},[e("span",null,s(n.id),1),e("span",null,"$"+s(n.amount_usd.toFixed(2)),1),e("span",null,s(n.status),1)]))),128))])):(o(),i("p",U,"No invoices yet."))]),_:1})],64))])}const J=k(v,[["render",A]]);export{J as default};
