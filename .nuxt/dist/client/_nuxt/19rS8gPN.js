import{_ as T}from"./CyeEiYbI.js";import{_ as S}from"./DyabKexD.js";import{_}from"./BwUjpYiu.js";import{u as w}from"./BIUpqFe3.js";import{e as I,c as o,b as m,F as y,r as b,o as n,i as k,w as c,a,t as l,k as K,g as v,j as N,h as r,v as p,d as g}from"./BpnP_1c4.js";import{_ as D}from"./DlAUqK2U.js";import"./Dvi7YPqy.js";import"./FoZdgCff.js";import"./BRJawhm2.js";import"./BIYn82lU.js";const V=[{type:"s3",title:"S3 (AWS)",description:"For datasets and knowledge base ingestion from S3 buckets.",placeholder:"e.g. AWS prod"},{type:"gcs",title:"GCS (Google Cloud)",description:"For datasets and knowledge base ingestion from Google Cloud Storage.",placeholder:"e.g. GCP prod"},{type:"hf",title:"Hugging Face",description:"For datasets from Hugging Face and model access.",placeholder:"e.g. HF token"}],$=I({name:"IntegrationsPage",data(){return{integrationTypes:V,credentials:[],loading:!0,addLoading:!1,testingId:null,addingType:null,addForms:{s3:{name:"",s3AccessKeyId:"",s3SecretAccessKey:"",s3Region:""},gcs:{name:"",gcsJson:""},hf:{name:"",hfToken:""}}}},computed:{credentialsByType(){const e={s3:[],gcs:[],hf:[]};return this.credentials.forEach(s=>{e[s.type]&&e[s.type].push(s)}),e}},setup(){const{apiFetch:e}=w();return{apiFetch:e}},async mounted(){await this.loadCredentials()},methods:{formatDate(e){try{return new Date(e).toLocaleDateString()}catch{return e}},async loadCredentials(){this.loading=!0;try{const e=await this.apiFetch("/api/org/credentials");this.credentials=e.credentials||[]}catch{this.credentials=[]}finally{this.loading=!1}},async testCredential(e){this.testingId=e;try{await this.apiFetch(`/api/org/credentials/${e}/test`,{method:"POST"}),await this.loadCredentials()}finally{this.testingId=null}},async deleteCredential(e){if(confirm("Delete this credential?"))try{await this.apiFetch(`/api/org/credentials/${e}`,{method:"DELETE"}),await this.loadCredentials()}catch(s){alert(s.message||"Delete failed")}},async onAddCredential(e){const s={},i=this.addForms[e];if(e==="s3")s.s3={accessKeyId:i.s3AccessKeyId,secretAccessKey:i.s3SecretAccessKey,region:i.s3Region||void 0};else if(e==="gcs")try{s.gcs={serviceAccountKey:JSON.parse(i.gcsJson||"{}")}}catch{alert("Invalid JSON for GCS service account");return}else s.hf={token:i.hfToken};const f=i.name||"Unnamed";this.addLoading=!0;try{await this.apiFetch("/api/org/credentials",{method:"POST",body:{name:f||"Unnamed",type:e,payload:s}}),this.addingType=null,this.addForms.s3={name:"",s3AccessKeyId:"",s3SecretAccessKey:"",s3Region:""},this.addForms.gcs={name:"",gcsJson:""},this.addForms.hf={name:"",hfToken:""},await this.loadCredentials()}catch(h){alert(h.message||"Add failed")}finally{this.addLoading=!1}}}}),J={class:"app-page"},L={key:0,class:"text-muted-foreground text-sm"},U={key:1,class:"space-y-6"},B={class:"app-section-title"},E={class:"app-section-description mt-1"},G={class:"space-y-2"},O={class:"text-foreground"},R={class:"text-muted-foreground text-xs"},H={class:"flex gap-2"},P=["disabled","onClick"],x=["onClick"],j={key:0,class:"text-muted-foreground text-sm"},M=["onSubmit"],W=["onUpdate:modelValue","placeholder"],z={key:1},Y={key:2},q={class:"flex gap-2"};function Q(e,s,i,f,h,X){const C=T,u=S,F=_;return n(),o("div",J,[m(C,{title:"Integrations",description:"Connect S3, GCS, and Hugging Face. Credentials are used for datasets and knowledge base ingestion."}),e.loading?(n(),o("p",L,"Loading…")):(n(),o("div",U,[(n(!0),o(y,null,b(e.integrationTypes,d=>(n(),k(F,{key:d.type,class:"space-y-4"},{default:c(()=>[a("div",null,[a("h3",B,l(d.title),1),a("p",E,l(d.description),1)]),a("ul",G,[(n(!0),o(y,null,b(e.credentialsByType[d.type],t=>(n(),o("li",{key:t.id,class:"flex items-center justify-between gap-2 rounded border border-border/50 bg-muted/30 px-3 py-2 text-sm"},[a("span",O,l(t.name),1),a("span",{class:K({"text-emerald-600":t.status==="ok","text-amber-600":t.status==="pending","text-destructive":t.status==="error"})},l(t.status),3),a("span",R,l(t.last_tested_at?"Tested "+e.formatDate(t.last_tested_at):"Not tested"),1),a("div",H,[a("button",{type:"button",class:"text-primary hover:underline",disabled:e.testingId===t.id,onClick:A=>e.testCredential(t.id)},l(e.testingId===t.id?"Testing…":"Test"),9,P),a("button",{type:"button",class:"text-destructive hover:underline",onClick:A=>e.deleteCredential(t.id)}," Delete ",8,x)])]))),128)),e.credentialsByType[d.type].length===0&&e.addingType!==d.type?(n(),o("p",j," No credentials yet. ")):v("",!0)]),e.addingType===d.type?(n(),o("form",{key:d.type,onSubmit:N(t=>e.onAddCredential(d.type),["prevent"]),class:"space-y-3 rounded border border-border/50 bg-muted/20 p-4"},[a("div",null,[s[6]||(s[6]=a("label",{class:"app-label"},"Name",-1)),r(a("input",{"onUpdate:modelValue":t=>e.addForms[d.type].name=t,class:"app-input",placeholder:d.placeholder},null,8,W),[[p,e.addForms[d.type].name]])]),d.type==="s3"?(n(),o(y,{key:0},[a("div",null,[s[7]||(s[7]=a("label",{class:"app-label"},"Access Key ID",-1)),r(a("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>e.addForms.s3.s3AccessKeyId=t),class:"app-input",type:"text"},null,512),[[p,e.addForms.s3.s3AccessKeyId]])]),a("div",null,[s[8]||(s[8]=a("label",{class:"app-label"},"Secret Access Key",-1)),r(a("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>e.addForms.s3.s3SecretAccessKey=t),class:"app-input",type:"password"},null,512),[[p,e.addForms.s3.s3SecretAccessKey]])]),a("div",null,[s[9]||(s[9]=a("label",{class:"app-label"},"Region (optional)",-1)),r(a("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>e.addForms.s3.s3Region=t),class:"app-input",placeholder:"us-east-1"},null,512),[[p,e.addForms.s3.s3Region]])])],64)):d.type==="gcs"?(n(),o("div",z,[s[10]||(s[10]=a("label",{class:"app-label"},"Service account JSON (paste full JSON)",-1)),r(a("textarea",{"onUpdate:modelValue":s[3]||(s[3]=t=>e.addForms.gcs.gcsJson=t),class:"app-input min-h-[120px] font-mono text-sm",placeholder:'{"type":"service_account",...}'},null,512),[[p,e.addForms.gcs.gcsJson]])])):d.type==="hf"?(n(),o("div",Y,[s[11]||(s[11]=a("label",{class:"app-label"},"Hugging Face token",-1)),r(a("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>e.addForms.hf.hfToken=t),class:"app-input",type:"password",placeholder:"hf_..."},null,512),[[p,e.addForms.hf.hfToken]])])):v("",!0),a("div",q,[m(u,{type:"submit",disabled:e.addLoading},{default:c(()=>[g(l(e.addLoading?"Adding…":"Add credential"),1)]),_:1},8,["disabled"]),m(u,{variant:"secondary",type:"button",onClick:s[5]||(s[5]=t=>e.addingType=null)},{default:c(()=>[...s[12]||(s[12]=[g(" Cancel ",-1)])]),_:1})])],40,M)):(n(),k(u,{key:1,variant:"secondary",onClick:t=>e.addingType=d.type},{default:c(()=>[g(" Add "+l(d.title)+" credential ",1)]),_:2},1032,["onClick"]))]),_:2},1024))),128))]))])}const re=D($,[["render",Q]]);export{re as default};
