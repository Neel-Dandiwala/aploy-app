import{_ as A}from"./BK5343vK.js";import{_ as E}from"./3gX_DK_6.js";import{e as k,f as P,o as n,c as r,a as s,F as m,h as y,v as _,j as c,r as v,k as g,t as f,i as R,b,w as h,d as x,g as B,p as S}from"./eG_W-IWR.js";import{_ as w}from"./DlAUqK2U.js";import{u as D}from"./C5yYOmo6.js";const T=k({name:"ChatPanel",data(){return{open:!0,messages:[],input:"",loading:!1,apiKey:"",listRef:null}},watch:{messages(){this.$nextTick(()=>{this.listRef&&this.listRef.scrollTo(0,this.listRef.scrollHeight)})}},methods:{async send(){const t=this.input.trim();if(!t||this.loading)return;this.input="",this.messages.push({role:"user",content:t}),this.loading=!0;const a=P().public.apiUrl;try{const i=await $fetch(`${a}/api/chat`,{method:"POST",credentials:"include",body:{messages:this.messages.map(l=>({role:l.role,content:l.content})),openai_api_key:this.apiKey||void 0}});this.messages.push({role:"assistant",content:i.reply||"Done.",actions:i.actions_taken?.length?i.actions_taken:void 0})}catch(i){const l=i;this.messages.push({role:"assistant",content:l?.data?.error||l?.message||"Request failed. Check API key."})}finally{this.loading=!1}}}}),V={key:1,class:"text-muted text-xs p-2",title:"Open chat"},N={class:"p-3 border-b border-border"},I={ref:"listRef",class:"flex-1 overflow-y-auto p-3 space-y-3 min-h-[200px] max-h-[calc(100vh-280px)]"},K={key:0,class:"text-muted text-sm"},O={class:"whitespace-pre-wrap"},U={key:0,class:"mt-2 pt-2 border-t border-border text-xs text-emerald-500"},L={key:1,class:"rounded-app bg-surface-overlay text-muted text-sm px-3 py-2 border border-border"},z={class:"p-3 border-t border-border"},F=["disabled"];function M(t,e,a,i,l,C){const p=E;return n(),r("div",{class:g(["flex flex-col border-l border-border bg-surface-elevated/95 transition-all duration-200",t.open?"w-[380px] min-w-[380px]":"w-12 min-w-[48px]"])},[s("button",{type:"button",class:"flex items-center justify-between p-3 border-b border-border text-left hover:bg-white/[0.04] transition-colors",onClick:e[0]||(e[0]=o=>t.open=!t.open)},[t.open?(n(),r(m,{key:0},[e[4]||(e[4]=s("span",{class:"text-sm font-medium text-white"},"Aploy assistant",-1)),e[5]||(e[5]=s("span",{class:"text-muted text-xs"},"◀",-1))],64)):(n(),r("span",V,"▶"))]),t.open?(n(),r(m,{key:0},[s("div",N,[e[6]||(e[6]=s("label",{class:"app-label"},"OpenAI API key (or set in API .env)",-1)),y(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.apiKey=o),type:"password",placeholder:"sk-...",class:"app-input py-1.5 text-xs"},null,512),[[_,t.apiKey]])]),s("div",I,[t.messages.length===0?(n(),r("p",K," Ask me to create a project, add a dataset, start training, or deploy. ")):c("",!0),(n(!0),r(m,null,v(t.messages,(o,d)=>(n(),r("div",{key:d,class:g(o.role==="user"?"flex justify-end":"")},[s("div",{class:g(["rounded-app text-sm px-3 py-2 max-w-[90%]",o.role==="user"?"bg-accent/90 text-white":"bg-surface-overlay text-muted-foreground border border-border"])},[s("div",O,f(o.content),1),o.actions?.length?(n(),r("div",U,[(n(!0),r(m,null,v(o.actions,(u,j)=>(n(),r("div",{key:j},f(u.action)+": "+f(typeof u.result=="object"&&u.result&&"id"in u.result?`created ${u.result.id}`:"ok"),1))),128))])):c("",!0)],2)],2))),128)),t.loading?(n(),r("div",L,"Thinking…")):c("",!0)],512),s("div",z,[s("form",{class:"flex gap-2",onSubmit:e[3]||(e[3]=R((...o)=>t.send&&t.send(...o),["prevent"]))},[y(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.input=o),type:"text",placeholder:"Create a project, add dataset…",class:"app-input flex-1 min-w-0 py-2",disabled:t.loading},null,8,F),[[_,t.input]]),b(p,{type:"submit",disabled:t.loading,size:"md"},{default:h(()=>[...e[7]||(e[7]=[x(" Send ",-1)])]),_:1},8,["disabled"])],32)])],64)):c("",!0)],2)}const $=w(T,[["render",M]]),q=k({name:"AppLayout",components:{ChatPanel:$},setup(){const{environment:t,setEnvironment:e}=D();return{environment:t,setEnvironment:e}},data(){return{nav:[{href:"/app",label:"Dashboard"},{href:"/app/datasets",label:"Datasets"},{href:"/app/projects",label:"Projects"},{href:"/app/runs",label:"Runs"},{href:"/app/evaluations",label:"Evaluations"},{href:"/app/registry",label:"Registry"},{href:"/app/deployments",label:"Deployments"},{href:"/app/billing",label:"Billing"},{href:"/app/settings",label:"Settings"},{href:"/app/org",label:"Org"}]}},methods:{onEnvironmentChange(t){const a=t.target?.value;(a==="sandbox"||a==="production")&&this.setEnvironment(a)}}}),H={class:"flex min-h-screen bg-surface"},G={class:"w-56 shrink-0 flex flex-col border-r border-border"},J={class:"p-4 border-b border-border"},Q={class:"flex-1 p-3 space-y-0.5"},W={class:"p-3 border-t border-border"},X={class:"flex-1 flex flex-col min-w-0"},Y={class:"flex items-center justify-end gap-3 px-6 py-3 border-b border-border shrink-0"},Z=["value"],ee={class:"flex-1 overflow-auto"};function te(t,e,a,i,l,C){const p=A,o=$;return n(),r("div",H,[s("aside",G,[s("div",J,[b(p,{to:"/",class:"text-lg font-semibold text-white tracking-tight"},{default:h(()=>[...e[1]||(e[1]=[x("Aploy",-1)])]),_:1})]),s("nav",Q,[(n(!0),r(m,null,v(t.nav,d=>(n(),B(p,{key:d.href,to:d.href,class:"flex items-center rounded-app px-3 py-2 text-sm text-muted-foreground hover:bg-white/[0.04] hover:text-white transition-colors"},{default:h(()=>[x(f(d.label),1)]),_:2},1032,["to"]))),128))]),s("div",W,[b(p,{to:"/",class:"flex items-center rounded-app px-3 py-2 text-sm text-muted hover:text-muted-foreground transition-colors"},{default:h(()=>[...e[2]||(e[2]=[x(" Back to home ",-1)])]),_:1})])]),s("div",X,[s("header",Y,[e[4]||(e[4]=s("span",{class:"text-sm text-muted"},"Environment",-1)),s("select",{value:t.environment,class:"app-input w-auto min-w-[120px] py-1.5 text-sm",onChange:e[0]||(e[0]=(...d)=>t.onEnvironmentChange&&t.onEnvironmentChange(...d))},[...e[3]||(e[3]=[s("option",{value:"sandbox"},"Sandbox",-1),s("option",{value:"production"},"Production",-1)])],40,Z)]),s("main",ee,[S(t.$slots,"default")])]),b(o)])}const ie=w(q,[["render",te]]);export{ie as default};
