import{_ as j}from"./Dvi7YPqy.js";import{_ as P}from"./DyabKexD.js";import{u as T}from"./BRJawhm2.js";import{e as w,f as A,o as n,c as r,a as s,F as c,h as y,v as _,g as m,r as x,k as v,t as f,j as R,b,w as h,d as g,i as I,p as B}from"./BpnP_1c4.js";import{_ as $}from"./DlAUqK2U.js";import{u as D}from"./FoZdgCff.js";const z=w({name:"ChatPanel",data(){return{open:!0,messages:[],input:"",loading:!1,apiKey:"",listRef:null}},watch:{messages(){this.$nextTick(()=>{this.listRef&&this.listRef.scrollTo(0,this.listRef.scrollHeight)})}},setup(){const{mockMode:e}=T();return{mockMode:e}},methods:{async send(){const e=this.input.trim();if(!(!e||this.loading)){this.input="",this.messages.push({role:"user",content:e}),this.loading=!0;try{if(this.mockMode?.value){await new Promise(d=>setTimeout(d,400)),this.messages.push({role:"assistant",content:"I've created the project and added a dataset. You can start a training run from the Runs page, then deploy from Deployments.",actions:[{action:"create_project",result:{id:"proj_mock1"}},{action:"add_dataset",result:{id:"ds_mock1"}}]}),this.loading=!1;return}const a=A().public.apiUrl,l=await $fetch(`${a}/api/chat`,{method:"POST",credentials:"include",body:{messages:this.messages.map(d=>({role:d.role,content:d.content})),openai_api_key:this.apiKey||void 0}});this.messages.push({role:"assistant",content:l.reply||"Done.",actions:l.actions_taken?.length?l.actions_taken:void 0})}catch(t){const a=t;this.messages.push({role:"assistant",content:a?.data?.error||a?.message||"Request failed. Check API key."})}finally{this.loading=!1}}}}}),K={key:1,class:"text-muted text-xs p-2",title:"Open chat"},M={class:"p-3 border-b border-border"},V={ref:"listRef",class:"flex-1 overflow-y-auto p-3 space-y-3 min-h-[200px] max-h-[calc(100vh-280px)]"},N={key:0,class:"text-muted text-sm"},O={class:"whitespace-pre-wrap"},U={key:0,class:"mt-2 pt-2 border-t border-border text-xs text-emerald-500"},L={key:1,class:"rounded-app bg-surface-overlay text-muted text-sm px-3 py-2 border border-border"},F={class:"p-3 border-t border-border"},Y=["disabled"];function q(e,t,a,l,d,E){const p=P;return n(),r("div",{class:v(["flex flex-col border-l border-border bg-surface-elevated/95 transition-all duration-200",e.open?"w-[380px] min-w-[380px]":"w-12 min-w-[48px]"])},[s("button",{type:"button",class:"flex items-center justify-between p-3 border-b border-border text-left hover:bg-white/[0.04] transition-colors",onClick:t[0]||(t[0]=o=>e.open=!e.open)},[e.open?(n(),r(c,{key:0},[t[4]||(t[4]=s("span",{class:"text-sm font-medium text-zinc-900"},"Aploy assistant",-1)),t[5]||(t[5]=s("span",{class:"text-muted text-xs"},"◀",-1))],64)):(n(),r("span",K,"▶"))]),e.open?(n(),r(c,{key:0},[s("div",M,[t[6]||(t[6]=s("label",{class:"app-label"},"OpenAI API key (or set in API .env)",-1)),y(s("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.apiKey=o),type:"password",placeholder:"sk-...",class:"app-input py-1.5 text-xs"},null,512),[[_,e.apiKey]])]),s("div",V,[e.messages.length===0?(n(),r("p",N," Ask me to create a project, add a dataset, start training, or deploy. ")):m("",!0),(n(!0),r(c,null,x(e.messages,(o,i)=>(n(),r("div",{key:i,class:v(o.role==="user"?"flex justify-end":"")},[s("div",{class:v(["rounded-app text-sm px-3 py-2 max-w-[90%]",o.role==="user"?"bg-accent/90 text-white":"bg-surface-overlay text-muted-foreground border border-border"])},[s("div",O,f(o.content),1),o.actions?.length?(n(),r("div",U,[(n(!0),r(c,null,x(o.actions,(u,S)=>(n(),r("div",{key:S},f(u.action)+": "+f(typeof u.result=="object"&&u.result&&"id"in u.result?`created ${u.result.id}`:"ok"),1))),128))])):m("",!0)],2)],2))),128)),e.loading?(n(),r("div",L,"Thinking…")):m("",!0)],512),s("div",F,[s("form",{class:"flex gap-2",onSubmit:t[3]||(t[3]=R((...o)=>e.send&&e.send(...o),["prevent"]))},[y(s("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.input=o),type:"text",placeholder:"Create a project, add dataset…",class:"app-input flex-1 min-w-0 py-2",disabled:e.loading},null,8,Y),[[_,e.input]]),b(p,{type:"submit",disabled:e.loading,size:"md"},{default:h(()=>[...t[7]||(t[7]=[g(" Send ",-1)])]),_:1},8,["disabled"])],32)])],64)):m("",!0)],2)}const C=$(z,[["render",q]]),k="aploy-environment",G=w({name:"AppLayout",components:{ChatPanel:C},data(){return{environment:"sandbox",nav:[{href:"/app",label:"Dashboard"},{href:"/app/datasets",label:"Datasets"},{href:"/app/projects",label:"Projects"},{href:"/app/runs",label:"Runs"},{href:"/app/evaluations",label:"Evaluations"},{href:"/app/registry",label:"Registry"},{href:"/app/deployments",label:"Deployments"},{href:"/app/knowledge-bases",label:"Knowledge bases"},{href:"/app/pipelines",label:"Pipelines"},{href:"/app/triggers",label:"Triggers"},{href:"/app/api-explorer",label:"API Explorer"},{href:"/app/billing",label:"Billing"},{href:"/app/settings",label:"Settings"},{href:"/app/integrations",label:"Integrations"},{href:"/app/org",label:"Org"}]}},mounted(){try{const e=localStorage.getItem(k);(e==="sandbox"||e==="production")&&(this.environment=e,this.syncEnvironmentToState(e))}catch{}},methods:{syncEnvironmentToState(e){const{setEnvironment:t}=D();t(e)},onEnvironmentChange(e){const a=e.target?.value;if(!(a!=="sandbox"&&a!=="production")){this.environment=a;try{localStorage.setItem(k,a)}catch{}this.syncEnvironmentToState(a)}}}}),H={class:"flex min-h-screen bg-surface"},J={class:"w-56 shrink-0 flex flex-col border-r border-border bg-surface-elevated"},Q={class:"p-4 border-b border-border"},W={class:"flex-1 p-3 space-y-0.5"},X={class:"p-3 border-t border-border"},Z={class:"flex-1 flex flex-col min-w-0"},ee={class:"flex items-center justify-end gap-3 px-6 py-3 border-b border-border shrink-0"},te=["value"],se={class:"flex-1 overflow-auto"};function oe(e,t,a,l,d,E){const p=j,o=C;return n(),r("div",H,[s("aside",J,[s("div",Q,[b(p,{to:"/",class:"text-lg font-semibold text-zinc-900 tracking-tight transition-colors hover:text-accent"},{default:h(()=>[...t[1]||(t[1]=[g("Aploy",-1)])]),_:1})]),s("nav",W,[(n(!0),r(c,null,x(e.nav,i=>(n(),I(p,{key:i.href,to:i.href,class:"flex items-center rounded-app px-3 py-2 text-sm text-muted-foreground hover:bg-surface-overlay hover:text-zinc-900 transition-colors duration-app"},{default:h(()=>[g(f(i.label),1)]),_:2},1032,["to"]))),128))]),s("div",X,[b(p,{to:"/",class:"flex items-center rounded-app px-3 py-2 text-sm text-muted-foreground hover:bg-surface-overlay hover:text-zinc-900 transition-colors duration-app"},{default:h(()=>[...t[2]||(t[2]=[g(" Back to home ",-1)])]),_:1})])]),s("div",Z,[s("header",ee,[t[4]||(t[4]=s("span",{class:"text-sm text-muted"},"Environment",-1)),s("select",{value:e.environment,class:"app-input w-auto min-w-[120px] py-1.5 text-sm",onChange:t[0]||(t[0]=(...i)=>e.onEnvironmentChange&&e.onEnvironmentChange(...i))},[...t[3]||(t[3]=[s("option",{value:"sandbox"},"Sandbox",-1),s("option",{value:"production"},"Production",-1)])],40,te)]),s("main",se,[B(e.$slots,"default")])]),b(o)])}const pe=$(G,[["render",oe]]);export{pe as default};
