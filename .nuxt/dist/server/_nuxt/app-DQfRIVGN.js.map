{"version":3,"file":"app-DQfRIVGN.js","sources":["../../../../components/ChatPanel.vue","../../../../layouts/app.vue"],"sourcesContent":["<template>\n  <div\n    class=\"flex flex-col border-l border-border bg-surface-elevated/95 transition-all duration-200\"\n    :class=\"open ? 'w-[380px] min-w-[380px]' : 'w-12 min-w-[48px]'\"\n  >\n    <button\n      type=\"button\"\n      class=\"flex items-center justify-between p-3 border-b border-border text-left hover:bg-white/[0.04] transition-colors\"\n      @click=\"open = !open\"\n    >\n      <template v-if=\"open\">\n        <span class=\"text-sm font-medium text-white\">Aploy assistant</span>\n        <span class=\"text-muted text-xs\">◀</span>\n      </template>\n      <template v-else>\n        <span class=\"text-muted text-xs p-2\" title=\"Open chat\">▶</span>\n      </template>\n    </button>\n    <template v-if=\"open\">\n      <div class=\"p-3 border-b border-border\">\n        <label class=\"app-label\">OpenAI API key (or set in API .env)</label>\n        <input\n          v-model=\"apiKey\"\n          type=\"password\"\n          placeholder=\"sk-...\"\n          class=\"app-input py-1.5 text-xs\"\n        />\n      </div>\n      <div ref=\"listRef\" class=\"flex-1 overflow-y-auto p-3 space-y-3 min-h-[200px] max-h-[calc(100vh-280px)]\">\n        <p v-if=\"messages.length === 0\" class=\"text-muted text-sm\">\n          Ask me to create a project, add a dataset, start training, or deploy.\n        </p>\n        <div\n          v-for=\"(msg, i) in messages\"\n          :key=\"i\"\n          :class=\"msg.role === 'user' ? 'flex justify-end' : ''\"\n        >\n          <div\n            :class=\"[\n              'rounded-app text-sm px-3 py-2 max-w-[90%]',\n              msg.role === 'user'\n                ? 'bg-accent/90 text-white'\n                : 'bg-surface-overlay text-muted-foreground border border-border',\n            ]\"\n          >\n            <div class=\"whitespace-pre-wrap\">{{ msg.content }}</div>\n            <div v-if=\"msg.actions?.length\" class=\"mt-2 pt-2 border-t border-border text-xs text-emerald-500\">\n              <div v-for=\"(a, j) in msg.actions\" :key=\"j\">\n                {{ a.action }}: {{ typeof a.result === 'object' && a.result && 'id' in a.result ? `created ${(a.result as { id: string }).id}` : 'ok' }}\n              </div>\n            </div>\n          </div>\n        </div>\n        <div v-if=\"loading\" class=\"rounded-app bg-surface-overlay text-muted text-sm px-3 py-2 border border-border\">Thinking…</div>\n      </div>\n      <div class=\"p-3 border-t border-border\">\n        <form class=\"flex gap-2\" @submit.prevent=\"send\">\n          <input\n            v-model=\"input\"\n            type=\"text\"\n            placeholder=\"Create a project, add dataset…\"\n            class=\"app-input flex-1 min-w-0 py-2\"\n            :disabled=\"loading\"\n          />\n          <AppButton type=\"submit\" :disabled=\"loading\" size=\"md\">\n            Send\n          </AppButton>\n        </form>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\ninterface Message {\n  role: 'user' | 'assistant'\n  content: string\n  actions?: Array<{ action: string; result: unknown }>\n}\n\nexport default defineComponent({\n  name: 'ChatPanel',\n  data() {\n    return {\n      open: true,\n      messages: [] as Message[],\n      input: '',\n      loading: false,\n      apiKey: '',\n      listRef: null as HTMLElement | null,\n    }\n  },\n  watch: {\n    messages() {\n      this.$nextTick(() => {\n        if (this.listRef) this.listRef.scrollTo(0, this.listRef.scrollHeight)\n      })\n    },\n  },\n  methods: {\n    async send() {\n      const text = this.input.trim()\n      if (!text || this.loading) return\n      this.input = ''\n      this.messages.push({ role: 'user', content: text })\n      this.loading = true\n      const config = useRuntimeConfig()\n      const apiUrl = config.public.apiUrl as string\n      try {\n        const data = await $fetch<{ reply: string; actions_taken?: Array<{ action: string; result: unknown }> }>(`${apiUrl}/api/chat`, {\n          method: 'POST',\n          credentials: 'include',\n          body: {\n            messages: this.messages.map((m) => ({ role: m.role, content: m.content })),\n            openai_api_key: this.apiKey || undefined,\n          },\n        })\n        this.messages.push({\n          role: 'assistant',\n          content: data.reply || 'Done.',\n          actions: data.actions_taken?.length ? data.actions_taken : undefined,\n        })\n      } catch (e: unknown) {\n        const err = e as { data?: { error?: string }; message?: string }\n        this.messages.push({\n          role: 'assistant',\n          content: err?.data?.error || err?.message || 'Request failed. Check API key.',\n        })\n      } finally {\n        this.loading = false\n      }\n    },\n  },\n})\n</script>\n","<template>\n  <div class=\"flex min-h-screen bg-surface\">\n    <aside class=\"w-56 shrink-0 flex flex-col border-r border-border\">\n      <div class=\"p-4 border-b border-border\">\n        <NuxtLink to=\"/\" class=\"text-lg font-semibold text-white tracking-tight\">Aploy</NuxtLink>\n      </div>\n      <nav class=\"flex-1 p-3 space-y-0.5\">\n        <NuxtLink\n          v-for=\"item in nav\"\n          :key=\"item.href\"\n          :to=\"item.href\"\n          class=\"flex items-center rounded-app px-3 py-2 text-sm text-muted-foreground hover:bg-white/[0.04] hover:text-white transition-colors\"\n        >\n          {{ item.label }}\n        </NuxtLink>\n      </nav>\n      <div class=\"p-3 border-t border-border\">\n        <NuxtLink\n          to=\"/\"\n          class=\"flex items-center rounded-app px-3 py-2 text-sm text-muted hover:text-muted-foreground transition-colors\"\n        >\n          Back to home\n        </NuxtLink>\n      </div>\n    </aside>\n    <div class=\"flex-1 flex flex-col min-w-0\">\n      <header class=\"flex items-center justify-end gap-3 px-6 py-3 border-b border-border shrink-0\">\n        <span class=\"text-sm text-muted\">Environment</span>\n        <select\n          :value=\"environment\"\n          class=\"app-input w-auto min-w-[120px] py-1.5 text-sm\"\n          @change=\"onEnvironmentChange\"\n        >\n          <option value=\"sandbox\">Sandbox</option>\n          <option value=\"production\">Production</option>\n        </select>\n      </header>\n      <main class=\"flex-1 overflow-auto\">\n        <slot />\n      </main>\n    </div>\n    <ChatPanel />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport ChatPanel from '~/components/ChatPanel.vue'\n\nexport default defineComponent({\n  name: 'AppLayout',\n  components: { ChatPanel },\n  setup() {\n    const { environment, setEnvironment } = useEnvironment()\n    return { environment, setEnvironment }\n  },\n  data() {\n    return {\n      nav: [\n        { href: '/app', label: 'Dashboard' },\n        { href: '/app/datasets', label: 'Datasets' },\n        { href: '/app/projects', label: 'Projects' },\n        { href: '/app/runs', label: 'Runs' },\n        { href: '/app/evaluations', label: 'Evaluations' },\n        { href: '/app/registry', label: 'Registry' },\n        { href: '/app/deployments', label: 'Deployments' },\n        { href: '/app/billing', label: 'Billing' },\n        { href: '/app/settings', label: 'Settings' },\n        { href: '/app/org', label: 'Org' },\n      ],\n    }\n  },\n  methods: {\n    onEnvironmentChange(e: Event) {\n      const target = e.target as HTMLSelectElement\n      const value = target?.value as 'sandbox' | 'production'\n      if (value === 'sandbox' || value === 'production') this.setEnvironment(value)\n    },\n  },\n})\n</script>\n"],"names":["_ssrRenderClass","_ssrInterpolate","_ssrRenderAttr","_push","_parent","ChatPanel","_ssrRenderAttrs","_mergeProps","_ssrRenderList","_createTextVNode","_toDisplayString"],"mappings":"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"}