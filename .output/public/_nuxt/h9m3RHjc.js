import{_ as c}from"./CyeEiYbI.js";import{_ as f}from"./Dvi7YPqy.js";import{_ as h}from"./BwUjpYiu.js";import{_ as w}from"./DyabKexD.js";import{u as K}from"./BIUpqFe3.js";import{e as k,c as n,b as i,a,w as r,o as s,t as l,g as y,d,F as _,r as b,h as C,v,i as A}from"./BpnP_1c4.js";import{_ as x}from"./DlAUqK2U.js";import"./FoZdgCff.js";import"./BRJawhm2.js";import"./BIYn82lU.js";const N=k({name:"OrgPage",data(){return{org:null,loadingOrg:!0,apiKeys:[],loadingKeys:!0,showCreateKey:!1,newKeyName:"",creatingKey:!1,newKeyRaw:""}},setup(){const{apiFetch:e}=K();return{apiFetch:e}},async mounted(){await Promise.all([this.loadOrg(),this.loadApiKeys()])},methods:{async loadOrg(){this.loadingOrg=!0;try{this.org=await this.apiFetch("/api/org")}catch{this.org=null}finally{this.loadingOrg=!1}},async loadApiKeys(){this.loadingKeys=!0;try{const e=await this.apiFetch("/api/org/api-keys");this.apiKeys=e.api_keys||[]}catch{this.apiKeys=[]}finally{this.loadingKeys=!1}},formatDate(e){try{return new Date(e).toLocaleDateString()}catch{return e}},async createApiKey(){if(this.newKeyName.trim()){this.creatingKey=!0;try{const e=await this.apiFetch("/api/org/api-keys",{method:"POST",body:{name:this.newKeyName.trim()}});this.newKeyRaw=e.raw_key,this.showCreateKey=!1,this.newKeyName="",await this.loadApiKeys()}catch(e){alert(e.message||"Create failed")}finally{this.creatingKey=!1}}},copyKeyThenClose(){this.newKeyRaw&&typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText(this.newKeyRaw),this.newKeyRaw=""},async revokeApiKey(e){if(confirm("Revoke this API key? It will stop working immediately."))try{await this.apiFetch(`/api/org/api-keys/${e}`,{method:"DELETE"}),await this.loadApiKeys()}catch(t){alert(t.message||"Revoke failed")}}}}),P={class:"app-page"},R={class:"space-y-4"},O={key:0,class:"app-section-description"},$={key:1,class:"text-muted-foreground text-sm"},F={class:"text-sm text-muted-foreground mt-3"},I={key:0,class:"text-muted-foreground text-sm"},D={key:1,class:"space-y-2"},T={class:"text-foreground"},L={class:"font-mono text-muted-foreground"},S={class:"text-muted-foreground text-xs"},B=["onClick"],V={key:0,class:"text-muted-foreground text-sm"},E={key:2,class:"mt-4 space-y-2 border-t border-border/50 pt-4"},z={class:"flex gap-2"},G={key:3,class:"mt-4 rounded border border-amber-500/50 bg-amber-500/10 p-3 text-sm"},H={class:"mt-2 block break-all font-mono text-xs"};function M(e,t,U,j,q,J){const u=c,g=f,m=h,p=w;return s(),n("div",P,[i(u,{title:"Organization"}),a("div",R,[i(m,null,{default:r(()=>[t[6]||(t[6]=a("h3",{class:"app-section-title mb-1"},"General",-1)),e.org?(s(),n("p",O," Name: "+l(e.org.name)+". Slug: "+l(e.org.slug)+". ",1)):e.loadingOrg?(s(),n("p",$,"Loading…")):y("",!0),a("p",F,[t[4]||(t[4]=d(" Manage S3, GCS, and Hugging Face in ",-1)),i(g,{to:"/app/integrations",class:"text-accent hover:text-accent-hover transition-colors"},{default:r(()=>[...t[3]||(t[3]=[d("Integrations",-1)])]),_:1}),t[5]||(t[5]=d(". ",-1))])]),_:1}),i(m,null,{default:r(()=>[t[12]||(t[12]=a("h3",{class:"app-section-title mb-4"},"API keys",-1)),e.loadingKeys?(s(),n("p",I,"Loading…")):(s(),n("ul",D,[(s(!0),n(_,null,b(e.apiKeys,o=>(s(),n("li",{key:o.id,class:"flex items-center justify-between gap-2 rounded border border-border/50 bg-muted/30 px-3 py-2 text-sm"},[a("span",T,l(o.name),1),a("span",L,l(o.key_prefix)+"…",1),a("span",S,l(o.last_used_at?"Used "+e.formatDate(o.last_used_at):"Never used"),1),a("button",{type:"button",class:"text-destructive hover:underline",onClick:Q=>e.revokeApiKey(o.id)}," Revoke ",8,B)]))),128)),!e.loadingKeys&&e.apiKeys.length===0?(s(),n("p",V," No API keys. Create one to call invoke APIs from scripts or external apps. ")):y("",!0)])),e.showCreateKey?(s(),n("div",E,[t[8]||(t[8]=a("label",{class:"app-label"},"Key name",-1)),C(a("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.newKeyName=o),class:"app-input",placeholder:"e.g. Production"},null,512),[[v,e.newKeyName]]),a("div",z,[i(p,{disabled:e.creatingKey,onClick:e.createApiKey},{default:r(()=>[d(l(e.creatingKey?"Creating…":"Create key"),1)]),_:1},8,["disabled","onClick"]),i(p,{variant:"secondary",onClick:t[1]||(t[1]=o=>{e.showCreateKey=!1,e.newKeyName=""})},{default:r(()=>[...t[7]||(t[7]=[d("Cancel",-1)])]),_:1})])])):y("",!0),e.newKeyRaw?(s(),n("div",G,[t[10]||(t[10]=a("p",{class:"font-medium text-amber-700 dark:text-amber-400"},"Copy your key now. It won’t be shown again.",-1)),a("code",H,l(e.newKeyRaw),1),i(p,{class:"mt-2",variant:"secondary",size:"sm",onClick:e.copyKeyThenClose},{default:r(()=>[...t[9]||(t[9]=[d("Copy and close",-1)])]),_:1},8,["onClick"])])):e.showCreateKey?y("",!0):(s(),A(p,{key:4,class:"mt-4",variant:"secondary",onClick:t[2]||(t[2]=o=>e.showCreateKey=!0)},{default:r(()=>[...t[11]||(t[11]=[d(" Create API key ",-1)])]),_:1}))]),_:1})])])}const ie=x(N,[["render",M]]);export{ie as default};
