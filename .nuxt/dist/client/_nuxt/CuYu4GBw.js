import{_ as h}from"./CyeEiYbI.js";import{_ as v}from"./DyabKexD.js";import{u as k}from"./BIUpqFe3.js";import{e as S,n as T,c as s,b as d,a as o,h as l,v as n,l as u,F as p,r as f,g as c,t as i,w as y,j as w,o as r,d as b}from"./BpnP_1c4.js";import{_ as C}from"./DlAUqK2U.js";import"./Dvi7YPqy.js";import"./FoZdgCff.js";import"./BRJawhm2.js";import"./BIYn82lU.js";const I=S({name:"NewDataset",data(){return{form:{name:"",sourceType:"upload",bucket:"",prefix:"",credentialId:"",hfDataset:""},credentials:[],loading:!1,error:""}},computed:{credentialsByType(){return this.credentials.filter(e=>e.type===this.form.sourceType)},hfCredentials(){return this.credentials.filter(e=>e.type==="hf")}},setup(){const{apiFetch:e}=k();return{apiFetch:e}},async mounted(){try{const e=await this.apiFetch("/api/org/credentials");this.credentials=e.credentials||[]}catch{this.credentials=[]}},methods:{async onSubmit(){this.error="",this.loading=!0;const e={name:this.form.name||"Untitled dataset",schema_ref:"chat"};this.form.sourceType==="s3"?e.source={type:"s3",bucket:this.form.bucket,prefix:this.form.prefix,credentialId:this.form.credentialId||void 0}:this.form.sourceType==="gcs"?e.source={type:"gcs",bucket:this.form.bucket,prefix:this.form.prefix,credentialId:this.form.credentialId||void 0}:this.form.sourceType==="hf"?e.source={type:"hf",dataset:this.form.hfDataset,credentialId:this.form.credentialId||void 0}:e.source={type:"upload"};try{const t=await this.apiFetch("/api/datasets",{method:"POST",body:e});await T(`/app/datasets/${t.id}`)}catch(t){this.error=t.message||"Failed to create dataset"}finally{this.loading=!1}}}}),V={class:"app-page-narrow"},D=["value"],U=["value"],F={key:0,class:"app-error"},B={class:"flex flex-wrap gap-3 pt-1"};function N(e,t,A,$,H,M){const g=h,m=v;return r(),s("div",V,[d(g,{title:"Add dataset",description:"Upload or connect S3/GCS/Hugging Face. JSONL format.","back-to":"/app/datasets","back-label":"Datasets"}),o("form",{onSubmit:t[7]||(t[7]=w((...a)=>e.onSubmit&&e.onSubmit(...a),["prevent"])),class:"space-y-6"},[o("div",null,[t[8]||(t[8]=o("label",{class:"app-label"},"Dataset name",-1)),l(o("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.name=a),class:"app-input",placeholder:"Support chat v1"},null,512),[[n,e.form.name]])]),o("div",null,[t[14]||(t[14]=o("label",{class:"app-label"},"Source",-1)),l(o("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.sourceType=a),class:"app-select"},[...t[9]||(t[9]=[o("option",{value:"upload"},"Upload",-1),o("option",{value:"s3"},"S3",-1),o("option",{value:"gcs"},"GCS",-1),o("option",{value:"hf"},"Hugging Face",-1)])],512),[[u,e.form.sourceType]]),e.form.sourceType==="s3"||e.form.sourceType==="gcs"?(r(),s(p,{key:0},[t[11]||(t[11]=o("label",{class:"app-label mt-2"},"Credential",-1)),l(o("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.credentialId=a),class:"app-select"},[t[10]||(t[10]=o("option",{value:""},"Select credential",-1)),(r(!0),s(p,null,f(e.credentialsByType,a=>(r(),s("option",{key:a.id,value:a.id},i(a.name)+" ("+i(a.type)+")",9,D))),128))],512),[[u,e.form.credentialId]]),l(o("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.bucket=a),class:"app-input mt-2",placeholder:"Bucket"},null,512),[[n,e.form.bucket]]),l(o("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.prefix=a),class:"app-input mt-2",placeholder:"Prefix (optional)"},null,512),[[n,e.form.prefix]])],64)):e.form.sourceType==="hf"?(r(),s(p,{key:1},[t[13]||(t[13]=o("label",{class:"app-label mt-2"},"Credential",-1)),l(o("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>e.form.credentialId=a),class:"app-select"},[t[12]||(t[12]=o("option",{value:""},"Select credential",-1)),(r(!0),s(p,null,f(e.hfCredentials,a=>(r(),s("option",{key:a.id,value:a.id},i(a.name),9,U))),128))],512),[[u,e.form.credentialId]]),l(o("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>e.form.hfDataset=a),class:"app-input mt-2",placeholder:"Dataset (e.g. username/dataset_name)"},null,512),[[n,e.form.hfDataset]])],64)):c("",!0)]),e.error?(r(),s("p",F,i(e.error),1)):c("",!0),o("div",B,[d(m,{type:"submit",disabled:e.loading},{default:y(()=>[b(i(e.loading?"Startingâ€¦":"Create dataset"),1)]),_:1},8,["disabled"]),d(m,{variant:"secondary",to:"/app/datasets"},{default:y(()=>[...t[15]||(t[15]=[b("Cancel",-1)])]),_:1})])],32)])}const K=C(I,[["render",N]]);export{K as default};
