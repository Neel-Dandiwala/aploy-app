{"version":3,"file":"index-CsU1oxMO.js","sources":["../../../../pages/app/triggers/index.vue"],"sourcesContent":["<template>\n  <div class=\"app-page\">\n    <AppPageHeader title=\"Triggers\">\n      <template #actions>\n        <AppButton @click=\"showCreate = true\">Create trigger</AppButton>\n      </template>\n    </AppPageHeader>\n    <p v-if=\"loading\" class=\"text-muted-foreground text-sm\">Loading…</p>\n    <p v-else-if=\"error\" class=\"app-error\">{{ error }}</p>\n    <div v-else class=\"space-y-2\">\n      <div\n        v-for=\"t in triggers\"\n        :key=\"t.id\"\n        class=\"rounded border border-border/50 bg-muted/30 px-4 py-3 flex flex-wrap items-center justify-between gap-2\"\n      >\n        <div>\n          <span class=\"font-medium\">{{ t.name }}</span>\n          <span class=\"text-muted-foreground text-sm ml-2\">{{ t.type }}</span>\n          <span class=\"text-muted-foreground text-sm ml-2\">Pipeline {{ t.pipeline_id }}</span>\n        </div>\n        <div class=\"flex items-center gap-2\">\n          <code v-if=\"t.webhook_url\" class=\"text-xs bg-surface-overlay px-2 py-1 rounded break-all max-w-md text-zinc-800\">{{ t.webhook_url }}</code>\n          <button type=\"button\" class=\"text-destructive text-sm hover:underline\" @click=\"deleteTrigger(t.id)\">Delete</button>\n        </div>\n      </div>\n      <p v-if=\"!loading && !error && triggers.length === 0\" class=\"text-muted-foreground text-sm\">\n        No triggers. Create a webhook to run a pipeline from Zapier, cron, or your app.\n      </p>\n    </div>\n    <AppCard v-if=\"showCreate\" class=\"mt-6\">\n      <h3 class=\"app-section-title mb-3\">Create trigger</h3>\n      <div class=\"space-y-3\">\n        <div>\n          <label class=\"app-label\">Pipeline</label>\n          <select v-model=\"createForm.pipeline_id\" class=\"app-select\">\n            <option value=\"\">Select pipeline</option>\n            <option v-for=\"p in pipelines\" :key=\"p.id\" :value=\"p.id\">{{ p.name }}</option>\n          </select>\n        </div>\n        <div>\n          <label class=\"app-label\">Name</label>\n          <input v-model=\"createForm.name\" class=\"app-input\" placeholder=\"Webhook\" />\n        </div>\n        <div>\n          <label class=\"app-label\">Type</label>\n          <select v-model=\"createForm.type\" class=\"app-select\">\n            <option value=\"webhook\">Webhook</option>\n          </select>\n        </div>\n        <div>\n          <label class=\"app-label\">Webhook secret (optional)</label>\n          <input v-model=\"createForm.webhook_secret\" class=\"app-input\" type=\"password\" placeholder=\"Set X-Webhook-Secret header\" />\n        </div>\n        <div class=\"flex gap-2\">\n          <AppButton :disabled=\"creating\" @click=\"onCreate\">{{ creating ? 'Creating…' : 'Create' }}</AppButton>\n          <AppButton variant=\"secondary\" @click=\"showCreate = false\">Cancel</AppButton>\n        </div>\n      </div>\n    </AppCard>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\ndefinePageMeta({ layout: 'app' })\n\ninterface TriggerItem {\n  id: string\n  pipeline_id: string\n  name: string\n  type: string\n  status: string\n  webhook_url?: string | null\n}\n\ninterface PipelineItem { id: string; name: string }\n\nexport default defineComponent({\n  name: 'TriggersList',\n  data() {\n    return {\n      triggers: [] as TriggerItem[],\n      pipelines: [] as PipelineItem[],\n      loading: true,\n      error: '',\n      showCreate: false,\n      creating: false,\n      createForm: {\n        pipeline_id: '',\n        name: 'Webhook',\n        type: 'webhook' as const,\n        webhook_secret: '',\n      },\n    }\n  },\n  setup() {\n    const { apiFetch } = useAployApi()\n    return { apiFetch }\n  },\n  async mounted() {\n    await Promise.all([this.loadTriggers(), this.loadPipelines()])\n  },\n  methods: {\n    async loadTriggers() {\n      this.loading = true\n      this.error = ''\n      try {\n        const data = await this.apiFetch<{ triggers: TriggerItem[] }>('/api/triggers')\n        this.triggers = data.triggers || []\n      } catch (e) {\n        this.error = (e as Error).message || 'Failed to load triggers'\n      } finally {\n        this.loading = false\n      }\n    },\n    async loadPipelines() {\n      try {\n        const data = await this.apiFetch<{ pipelines: PipelineItem[] }>('/api/pipelines')\n        this.pipelines = data.pipelines || []\n      } catch {\n        this.pipelines = []\n      }\n    },\n    async onCreate() {\n      if (!this.createForm.pipeline_id) return\n      this.creating = true\n      try {\n        await this.apiFetch('/api/triggers', {\n          method: 'POST',\n          body: {\n            pipeline_id: this.createForm.pipeline_id,\n            name: this.createForm.name || 'Webhook',\n            type: this.createForm.type,\n            webhook_secret: this.createForm.webhook_secret || undefined,\n          },\n        })\n        this.showCreate = false\n        this.createForm = { pipeline_id: '', name: 'Webhook', type: 'webhook', webhook_secret: '' }\n        await this.loadTriggers()\n      } catch (e) {\n        alert((e as Error).message || 'Create failed')\n      } finally {\n        this.creating = false\n      }\n    },\n    async deleteTrigger(id: string) {\n      if (!confirm('Delete this trigger?')) return\n      try {\n        await this.apiFetch(`/api/triggers/${id}`, { method: 'DELETE' })\n        await this.loadTriggers()\n      } catch (e) {\n        alert((e as Error).message || 'Delete failed')\n      }\n    },\n  },\n})\n</script>\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderComponent","_withCtx","_push","_parent","_","_scopeId","_createVNode","_createTextVNode","_ssrRenderList","_ssrInterpolate","_ssrIncludeBooleanAttr","_ssrLooseContain","_ssrLooseEqual","_ssrRenderAttr","_withDirectives","_openBlock","_createBlock","_Fragment","_renderList","_toDisplayString","_vModelSelect","_vModelText"],"mappings":"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"}