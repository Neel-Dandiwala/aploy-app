import{_ as k}from"./CyeEiYbI.js";import{_ as C}from"./DyabKexD.js";import{_ as D}from"./BwUjpYiu.js";import{e as T,f as g,c as d,b as u,a as s,w as m,i as x,g as b,o as r,h as y,F as $,r as w,t as i,l as U,v as S,d as h,k as B}from"./BpnP_1c4.js";import{u as N}from"./BIUpqFe3.js";import{u as q}from"./BRJawhm2.js";import{_ as I}from"./DlAUqK2U.js";import"./Dvi7YPqy.js";import"./FoZdgCff.js";import"./BIYn82lU.js";const _=T({name:"ApiExplorer",data(){return{deployments:[],loading:!0,selectedDeploymentId:"",requestBody:'{"messages": [{"role": "user", "content": "Hello"}], "max_tokens": 128}',apiKey:"",sending:!1,response:null,responseStatus:null,responseTime:null}},computed:{invokeUrl(){const e=g().public.apiUrl||"http://localhost:4000";return this.selectedDeploymentId?`${e.replace(/\/$/,"")}/v1/deployments/${this.selectedDeploymentId}/invoke`:e+"/v1/deployments/:id/invoke"},responseText(){if(this.response===null)return"";try{return JSON.stringify(JSON.parse(this.response),null,2)}catch{return this.response}},statusClass(){return this.responseStatus===null?"":this.responseStatus>=200&&this.responseStatus<300?"text-emerald-600":this.responseStatus>=400?"text-destructive":"text-amber-600"}},async mounted(){await this.loadDeployments()},methods:{async loadDeployments(){this.loading=!0;try{const t=await this.apiFetch("/api/deploy");this.deployments=t.deployments||[],this.deployments.length&&!this.selectedDeploymentId&&(this.selectedDeploymentId=this.deployments[0].id)}catch{this.deployments=[]}finally{this.loading=!1}},async sendRequest(){if(!this.selectedDeploymentId)return;let t;try{t=this.requestBody.trim()?JSON.parse(this.requestBody):{}}catch{this.response="Invalid JSON in request body",this.responseStatus=0,this.responseTime=null;return}this.sending=!0,this.response=null,this.responseStatus=null,this.responseTime=null;const e=Date.now();try{if(this.mockMode?.value){await new Promise(p=>setTimeout(p,300)),this.responseStatus=200,this.response=JSON.stringify({choices:[{message:{role:"assistant",content:"Mock response from deployed model."}}]},null,2),this.responseTime=Date.now()-e,this.sending=!1;return}const f=`${(g().public.apiUrl||"http://localhost:4000").replace(/\/$/,"")}/v1/deployments/${this.selectedDeploymentId}/invoke`,c={"Content-Type":"application/json","X-Environment":this.environment?.value??"production"};this.apiKey.trim()&&(c.Authorization=`Bearer ${this.apiKey.trim()}`);const a=await $fetch(f,{method:"POST",body:t,credentials:this.apiKey.trim()?"omit":"include",headers:c});this.responseStatus=200,this.response=typeof a=="string"?a:JSON.stringify(a)}catch(l){const o=l;this.responseStatus=o.response?.status??0,this.response=o.data!=null?JSON.stringify(o.data,null,2):l.message}finally{this.responseTime=Date.now()-e,this.sending=!1}},copyCurl(){let t;try{t=this.requestBody.trim()?JSON.stringify(JSON.parse(this.requestBody)):"{}"}catch{t="{}"}const e=this.apiKey.trim()?` -H "Authorization: Bearer ${this.apiKey.trim()}"`:"",l=`curl -X POST "${this.invokeUrl}" -H "Content-Type: application/json"${e} -d '${t}'`;typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText(l);try{const o=document.createElement("textarea");o.value=l,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}catch{}}},setup(){const{apiFetch:t,apiUrl:e,environment:l}=N(),{mockMode:o}=q();return{apiFetch:t,apiUrl:e,environment:l,mockMode:o}}}),O={class:"app-page"},A={class:"space-y-4"},J={class:"space-y-3"},K=["value"],R={class:"font-mono text-sm text-muted-foreground break-all"},M={class:"flex flex-wrap gap-2"},V={class:"text-sm text-muted-foreground mb-2"},E={key:0,class:"ml-2"},P={class:"rounded bg-muted/50 p-3 text-xs overflow-auto max-h-[400px]"};function H(t,e,l,o,f,c){const a=k,p=C,v=D;return r(),d("div",O,[u(a,{title:"API Explorer",description:"Try your deployed model. Send a request and see the response."}),s("div",A,[u(v,null,{default:m(()=>[e[9]||(e[9]=s("h3",{class:"app-section-title mb-3"},"Request",-1)),s("div",J,[s("div",null,[e[4]||(e[4]=s("label",{class:"app-label"},"Deployment (trained model)",-1)),y(s("select",{"onUpdate:modelValue":e[0]||(e[0]=n=>t.selectedDeploymentId=n),class:"app-select"},[e[3]||(e[3]=s("option",{value:""},"Select a deployment",-1)),(r(!0),d($,null,w(t.deployments,n=>(r(),d("option",{key:n.id,value:n.id},i(n.id)+" — "+i(n.model_version_id)+" ("+i(n.status)+") ",9,K))),128))],512),[[U,t.selectedDeploymentId]])]),s("div",null,[e[5]||(e[5]=s("label",{class:"app-label"},"API key (optional — leave blank to use session)",-1)),y(s("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>t.apiKey=n),class:"app-input font-mono text-sm",type:"password",placeholder:"aploy_..."},null,512),[[S,t.apiKey]])]),s("div",null,[e[6]||(e[6]=s("label",{class:"app-label"},"URL",-1)),s("p",R,i(t.invokeUrl),1)]),s("div",null,[e[7]||(e[7]=s("label",{class:"app-label"},"Request body (JSON)",-1)),y(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=n=>t.requestBody=n),class:"app-input min-h-[180px] font-mono text-sm",placeholder:'{"messages": [{"role": "user", "content": "Hello"}], "max_tokens": 128}'},null,512),[[S,t.requestBody]])]),s("div",M,[u(p,{disabled:!t.selectedDeploymentId||t.sending,onClick:t.sendRequest},{default:m(()=>[h(i(t.sending?"Sending…":"Send"),1)]),_:1},8,["disabled","onClick"]),u(p,{variant:"secondary",disabled:!t.invokeUrl,onClick:t.copyCurl},{default:m(()=>[...e[8]||(e[8]=[h(" Copy as cURL ",-1)])]),_:1},8,["disabled","onClick"])])])]),_:1}),t.response!==null?(r(),x(v,{key:0},{default:m(()=>[e[11]||(e[11]=s("h3",{class:"app-section-title mb-2"},"Response",-1)),s("p",V,[e[10]||(e[10]=h(" Status: ",-1)),s("span",{class:B(t.statusClass)},i(t.responseStatus),3),t.responseTime!==null?(r(),d("span",E,"· "+i(t.responseTime)+" ms",1)):b("",!0)]),s("pre",P,i(t.responseText),1)]),_:1})):b("",!0)])])}const ee=I(_,[["render",H]]);export{ee as default};
