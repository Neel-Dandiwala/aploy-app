{"version":3,"file":"useAployApi-BEdJYRuf.js","sources":["../../../../composables/useAployApi.ts"],"sourcesContent":["/**\n * Returns options and helpers for calling the Aploy API with the current\n * environment (X-Environment: sandbox | production). When mock mode is on\n * (frontend-only deployment), all requests are satisfied by in-memory mocks.\n */\nexport function useAployApi() {\n  const config = useRuntimeConfig()\n  const apiUrl = (config.public.apiUrl as string) || 'http://localhost:4000'\n  const { environment } = useEnvironment()\n  const { mockMode } = useMockMode()\n\n  function apiHeaders(): Record<string, string> {\n    return {\n      'X-Environment': environment.value,\n    }\n  }\n\n  async function apiFetch<T>(\n    path: string,\n    options: { method?: string; body?: unknown; query?: Record<string, string>; headers?: Record<string, string> } = {}\n  ): Promise<T> {\n    if (mockMode.value) {\n      const { mockFetch } = useMockApi()\n      return mockFetch<T>(path, options)\n    }\n    const url = path.startsWith('http') ? path : `${apiUrl}${path}`\n    return $fetch<T>(url, {\n      ...options,\n      credentials: 'include',\n      headers: {\n        ...apiHeaders(),\n        ...(options.headers as Record<string, string>),\n      },\n    })\n  }\n\n  return { apiUrl, apiHeaders, apiFetch, environment }\n}\n"],"names":[],"mappings":";;;;AAKO,SAAS,cAAc;AAC5B,QAAM,SAAS,iBAAA;AACf,QAAM,SAAU,OAAO,OAAO,UAAqB;AACnD,QAAM,EAAE,YAAA,IAAgB,eAAA;AACxB,QAAM,EAAE,SAAA,IAAa,YAAA;AAErB,WAAS,aAAqC;AAC5C,WAAO;AAAA,MACL,iBAAiB,YAAY;AAAA,IAAA;AAAA,EAEjC;AAEA,iBAAe,SACb,MACA,UAAiH,IACrG;AACZ,QAAI,SAAS,OAAO;AAClB,YAAM,EAAE,UAAA,IAAc,WAAA;AACtB,aAAO,UAAa,MAAM,OAAO;AAAA,IACnC;AACA,UAAM,MAAM,KAAK,WAAW,MAAM,IAAI,OAAO,GAAG,MAAM,GAAG,IAAI;AAC7D,WAAO,OAAU,KAAK;AAAA,MACpB,GAAG;AAAA,MACH,aAAa;AAAA,MACb,SAAS;AAAA,QACP,GAAG,WAAA;AAAA,QACH,GAAI,QAAQ;AAAA,MAAA;AAAA,IACd,CACD;AAAA,EACH;AAEA,SAAO,EAAE,QAAQ,YAAY,UAAU,YAAA;AACzC;"}